<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'Schulungsbericht - ' + ${employee.name}">Schulungsbericht</title>
    <link rel="stylesheet" th:href="@{/css/print.css}">
</head>
<body class="print-container">
    <div class="no-print">
        <button class="print-btn" onclick="window.print()">üñ®Ô∏è Drucken</button>
        <a th:href="@{/reports/employee-training-report(employeeId=${employee.id},targetDate=${targetDate})}" class="print-btn print-btn-secondary">‚Üê Zur√ºck</a>
    </div>

    <h1 class="print-header" th:text="'Schulungsbericht - ' + ${employee.name}">Schulungsbericht</h1>
    
    <div class="print-info-box">
        <p class="print-info-line"><strong>Mitarbeiter:</strong> <span th:text="${employee.name}">Max Mustermann</span></p>
        <p class="print-info-line"><strong>Abteilung:</strong> <span th:text="${employee.department != null ? employee.department.name : 'Keine Abteilung'}">IT</span></p>
        <p class="print-info-line"><strong>Stichtag:</strong> <span th:text="${#temporals.format(targetDate, 'dd.MM.yyyy')}">01.01.2025</span></p>
        <p class="print-info-line"><strong>Erstellt:</strong> <span th:text="${#temporals.format(#temporals.createNow(), 'dd.MM.yyyy HH:mm')}">01.01.2025 12:00</span></p>
    </div>

    <div class="summary-container">
        <div class="summary-box warning">
            <h3>F√§llige Schulungen</h3>
            <p th:text="${dueTrainingsCount}">0</p>
        </div>
        <div class="summary-box danger">
            <h3>√úberf√§llig</h3>
            <p th:text="${overdueCount}">0</p>
        </div>
        <div class="summary-box" th:classappend="${dueTrainingsCount == 0 ? '' : 'warning'}">
            <h3>Status</h3>
            <p th:text="${dueTrainingsCount == 0 ? '‚úì' : '-'}">-</p>
        </div>
    </div>

    <h2>Pflichtschulungen</h2>
    
    <table class="print-table">
        <thead>
            <tr>
                <th>Schulung</th>
                <th>Beschreibung</th>
                <th>Intervall</th>
                <th>Letzte Teilnahme</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${employee.mandatoryTrainings.isEmpty()}">
                <td colspan="5" class="empty-state">Keine Pflichtschulungen zugewiesen</td>
            </tr>
            <tr th:each="training : ${employee.mandatoryTrainings}">
                <td th:text="${training.title}">Schulung</td>
                <td th:text="${training.description}">Beschreibung</td>
                <td>
                    <span th:if="${training.interval != null}" 
                          th:text="${training.interval + ' Monate'}">12 Monate</span>
                    <span th:if="${training.interval == null}">-</span>
                </td>
                <td>
                    <span th:if="${lastAttendedDates.get(training) != null}" 
                          th:text="${#temporals.format(lastAttendedDates.get(training), 'dd.MM.yyyy')}">01.01.2024</span>
                    <span th:if="${lastAttendedDates.get(training) == null}" class="overdue-mark">
                        Noch nie
                    </span>
                </td>
                <td style="text-align: center;">
                    <span th:if="${lastAttendedDates.get(training) == null}" class="overdue-mark">
                        √úBERF√ÑLLIG
                    </span>
                    <span th:if="${lastAttendedDates.get(training) != null && lastAttendedDates.get(training).isBefore(#temporals.createToday())}" 
                          class="status-needs">
                        √úberf√§llig
                    </span>
                    <span th:if="${lastAttendedDates.get(training) != null && !lastAttendedDates.get(training).isBefore(#temporals.createToday())}" 
                          class="status-current">
                        Aktuell
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
    
    <div class="print-legend">
        <h4>Legende:</h4>
        <ul>
            <li><span class="overdue-mark">√úBERF√ÑLLIG</span> = Schulung wurde noch nie absolviert</li>
            <li><span class="status-needs">√úberf√§llig</span> = Schulung ist f√§llig (basierend auf letzter Teilnahme und Intervall)</li>
            <li><span class="status-current">Aktuell</span> = Schulung ist aktuell (noch nicht f√§llig)</li>
        </ul>
    </div>
</body>
</html>
